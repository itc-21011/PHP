 # リダイレクト処理にまつわる脆弱性

 ## 攻撃手法と理屈
 - オープンリダイレクト脆弱性を悪用した典型的な攻撃パターン  
１．攻撃者が、利用者にメールやSNSなどで罠のURLを閲覧するように仕向ける  
２．IDやパスワードを入力させ罠のページに遷移させる  
３．利用者が気づかないまま重要情報が盗まれる
 - HTTPヘッダ・インジェクション脆弱性を悪用した攻撃手法  
１．パラメータに改行を挿入することにより、新たなHTTPレスポンスヘッダを追加する  
２．任意のクッキー生成  
	→　セッションIDの固定化攻撃との組み合わせで、利用者に対する成りすまし攻撃ができる  
３．偽画面の表示
 ## 対策
 - オープンリダイレクト脆弱性を悪用した典型的な攻撃パターンの場合  
１．リダイレクト先のURLを固定にする  
	→　固定できない場合は、リダイレクト先を許可されたドメインのみに制御する
２．リダイレクト先のURLを直接指定せず番号指定にする  
３．リダイレクト先のドメイン名をチェックする
 - HTTPヘッダ・インジェクション脆弱性を悪用した攻撃手法の場合  
１．リダイレクト先をURLとして直接指定するのではなく、固定にするか番号などで指定する  
２．Webアプリケーション開発ツールの提供するセッション変数を使ってURLを受け渡す  
３．リダイレクトやクッキー生成を専用APIにまかせる  
４．ヘッダ生成するパラメータの改行文字をチェックする
